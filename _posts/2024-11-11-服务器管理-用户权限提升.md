---
layout:     post
title:      服务器管理-用户权限提升
subtitle:   总结了如何在 Linux 系统中提升用户权限，便于今后管理服务器和其他系统操作。
date:       2024-11-11
author:     Space
header-img: img/the-first.png
catalog:   true
tags:
    - 服务器管理


---



# Linux 用户权限提升学习记录

## 背景

在 Linux 系统中，管理员（即 `root` 用户）拥有对系统的完全控制权限。为了便于管理，其他普通用户可以被授予某些特权，执行需要管理员权限的操作。这篇文档记录了如何提升其他用户的权限，并确保操作成功。

## 目标

我们将把一个普通用户（例如 `guojilong`）提升为具有管理员权限的用户，使其可以执行 `sudo` 命令，管理系统。

## 步骤

### 1. **确认目标用户是否存在**

首先，需要确认要提升权限的用户是否已经存在。可以使用以下命令查看系统中的所有用户：

```bash
cut -d: -f1 /etc/passwd
```

这个命令会输出系统中所有的用户名。如果目标用户（例如 `guojilong`）在输出中，则表示该用户已经存在。如果没有找到该用户，需要先创建该用户。

### 2. **将用户加入 `sudo` 组**

为了将用户提升为管理员，我们需要将目标用户加入 `sudo` 组。假设目标用户为 `guojilong`，可以使用以下命令：

```bash
sudo usermod -aG sudo guojilong
```

这条命令的作用是将 `guojilong` 用户添加到 `sudo` 组。加入 `sudo` 组后，用户将能够使用 `sudo` 执行管理员权限的命令。

### 3. **验证用户是否成功加入 `sudo` 组**

可以通过以下命令来检查用户是否成功加入 `sudo` 组：

```bash
groups guojilong
```

如果输出类似以下内容：

```yaml
guojilong : guojilong sudo aptuser
```

则表示 `guojilong` 用户已经是 `sudo` 组的成员，拥有了管理员权限。

### 4. **让目标用户验证 `sudo` 权限**

为了确保目标用户已经成功获得管理员权限，可以要求该用户尝试执行一个需要管理员权限的命令。例如：

```bash
sudo whoami
```

系统将提示用户输入其密码。如果权限提升成功，输出应为 `root`，表示该用户已经拥有管理员权限。

### 5. **其他验证方法**

除了上述方法，还可以通过以下方式确认用户是否加入了 `sudo` 组：

#### 通过 `id` 命令：

```bash
id guojilong
```

输出中应该包含 `sudo` 组，类似于：

```scss
uid=1001(guojilong) gid=1001(guojilong) groups=1001(guojilong),27(sudo)
```

#### 通过 `/etc/group` 文件：

你还可以查看 `/etc/group` 文件，直接查找 `sudo` 组的成员：

```bash
grep sudo /etc/group
```

输出中应该包含目标用户：

```ruby
sudo:x:27:tsinghua-adept,guojilong
```

### 6. **总结**

- 成功将用户 `guojilong` 添加到 `sudo` 组后，该用户将能够执行管理员权限的操作。
- 使用 `groups` 或 `id` 命令来确认用户是否已成功加入 `sudo` 组。
- 让目标用户通过 `sudo whoami` 命令验证其是否能够使用管理员权限。

## 常见问题

1. **没有输入密码就结束了，是否成功？**

   - 如果命令执行没有报错，并且没有要求输入密码，可能是因为当前会话已经在短时间内验证过密码，或者你的用户已经具有 `sudo` 权限。你可以通过其他验证方法确认权限是否生效。

2. **目标用户没有在 `/etc/passwd` 中找到？**

   - 如果目标用户不存在，你需要先创建该用户。可以使用以下命令创建用户：

     ```bash
     sudo adduser guojilong
     ```

3. **如何让权限生效？**

   - 修改完用户组后，用户需要重新登录，或者可以通过运行 `newgrp sudo` 命令使更改立即生效。

------

### 附录：常用命令

- **查看系统所有用户**：

  ```bash
  cut -d: -f1 /etc/passwd
  ```

- **将用户添加到 `sudo` 组**：

  ```bash
  sudo usermod -aG sudo username
  ```

- **检查用户的组信息**：

  ```bash
  groups username
  ```

- **查看用户的详细组信息**：

  ```bash
  id username
  ```

- **验证 `sudo` 权限**：

  ```bash
  sudo whoami
  ```
